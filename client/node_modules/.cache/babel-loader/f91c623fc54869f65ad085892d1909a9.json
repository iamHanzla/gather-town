{"ast":null,"code":"var _jsxFileName = \"/Users/shubhamkapoor/nodejs-chat/client/src/Room/VideoGrid.js\";\nimport React, { useState, useEffect, useRef } from 'react';\nimport './VideoGrid.css';\nimport Peer from 'peerjs';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function VideoGrid({\n  socket,\n  name,\n  room\n}) {\n  const videoGrid = document.getElementById('video-grid');\n  const myPeer = new Peer(undefined, {\n    host: '/',\n    port: '3001'\n  });\n  const myVideo = document.createElement('video');\n  myVideo.muted = true;\n  const peers = {};\n  navigator.mediaDevices.getUserMedia({\n    video: true,\n    audio: true\n  }).then(stream => {\n    addVideoStream(myVideo, stream);\n    myPeer.on('call', call => {\n      call.answer(stream);\n      const video = document.createElement('video');\n      call.on('stream', userVideoStream => {\n        addVideoStream(video, userVideoStream);\n      });\n    });\n    socket.on('user-connected', userId => {\n      connectToNewUser(userId, stream);\n    });\n  });\n  socket.on('user-disconnected', userId => {\n    if (peers[userId]) peers[userId].close();\n  });\n  myPeer.on('open', id => {\n    socket.emit('join-room', room, id);\n  });\n\n  function connectToNewUser(userId, stream) {\n    const call = myPeer.call(userId, stream);\n    const video = document.createElement('video');\n    call.on('stream', userVideoStream => {\n      addVideoStream(video, userVideoStream);\n    });\n    call.on('close', () => {\n      video.remove();\n    });\n    peers[userId] = call;\n  }\n\n  function addVideoStream(video, stream) {\n    video.srcObject = stream;\n    video.addEventListener('loadedmetadata', () => {\n      video.play();\n    });\n    videoGrid.append(video);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"video-grid\",\n    children: \"Video Player\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 3\n  }, this);\n}\n_c = VideoGrid;\n\nvar _c;\n\n$RefreshReg$(_c, \"VideoGrid\");","map":{"version":3,"sources":["/Users/shubhamkapoor/nodejs-chat/client/src/Room/VideoGrid.js"],"names":["React","useState","useEffect","useRef","Peer","VideoGrid","socket","name","room","videoGrid","document","getElementById","myPeer","undefined","host","port","myVideo","createElement","muted","peers","navigator","mediaDevices","getUserMedia","video","audio","then","stream","addVideoStream","on","call","answer","userVideoStream","userId","connectToNewUser","close","id","emit","remove","srcObject","addEventListener","play","append"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react'\nimport './VideoGrid.css'\nimport Peer from 'peerjs'\n\nexport default function VideoGrid({ socket, name, room }) {\n\tconst videoGrid = document.getElementById('video-grid')\n\tconst myPeer = new Peer(undefined, {\n\t\thost: '/',\n\t\tport: '3001'\n\t})\n\tconst myVideo = document.createElement('video')\n\tmyVideo.muted = true\n\tconst peers = {}\n\tnavigator.mediaDevices.getUserMedia({\n\t\tvideo: true,\n\t\taudio: true\n\t}).then(stream => {\n\t\taddVideoStream(myVideo, stream)\n\t\n\t\tmyPeer.on('call', call => {\n\t\t\tcall.answer(stream)\n\t\t\tconst video = document.createElement('video')\n\t\t\tcall.on('stream', userVideoStream => {\n\t\t\t\taddVideoStream(video, userVideoStream)\n\t\t\t})\n\t\t})\n\t\n\t\tsocket.on('user-connected', userId => {\n\t\t\tconnectToNewUser(userId, stream)\n\t\t})\n\t})\n\t\n\tsocket.on('user-disconnected', userId => {\n\t\tif (peers[userId]) peers[userId].close()\n\t})\n\t\n\tmyPeer.on('open', id => {\n\t\tsocket.emit('join-room', room, id)\n\t})\n\t\n\tfunction connectToNewUser(userId, stream) {\n\t\tconst call = myPeer.call(userId, stream)\n\t\tconst video = document.createElement('video')\n\t\tcall.on('stream', userVideoStream => {\n\t\t\taddVideoStream(video, userVideoStream)\n\t\t})\n\t\tcall.on('close', () => {\n\t\t\tvideo.remove()\n\t\t})\n\t\n\t\tpeers[userId] = call\n\t}\n\t\n\tfunction addVideoStream(video, stream) {\n\t\tvideo.srcObject = stream\n\t\tvideo.addEventListener('loadedmetadata', () => {\n\t\t\tvideo.play()\n\t\t})\n\t\tvideoGrid.append(video)\n\t}\n\n\treturn (\n\t\t<div id=\"video-grid\">\n\t\t\tVideo Player\n\t\t</div>\n\t)\n}"]},"metadata":{},"sourceType":"module"}